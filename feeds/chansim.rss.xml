<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>工匠安全实验室 | 专注于工控安全</title><link>http://icsmaster.com/</link><description></description><atom:link href="http://icsmaster.com/feeds/chansim.rss.xml" rel="self"></atom:link><lastBuildDate>Wed, 15 Nov 2017 10:43:00 +0800</lastBuildDate><item><title>工控安全半月报第二期（2017-11 上）</title><link>http://icsmaster.com/news/monthly_report_11_1.html</link><description>&lt;blockquote&gt;
&lt;p&gt;工匠安全实验室最新版块，专注工控安全的我们，精选近期全球范围内工控领域的重要事件，让您及时了解行业发展动态，洞悉行业尖端技术，探寻行业前进方向。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;行业动态&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://mp.weixin.qq.com/s/Ey-GiJ9Gx_tgS75LOOmbjA"&gt;中国关键信息基础设施技术创新联盟启航在即 --联盟成立大会预备会在京召开&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://mp.weixin.qq.com/s/eNhtgWjxHXq_LQevnqs6Iw"&gt;上半年工业自动化系统遭约18000种恶意软件修改&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://hackernews.cc/archives/16550"&gt;美多家 ISP 经历大范围网络故障：又是“乌龙指”的错？&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://mp.weixin.qq.com/s/2Iq66QhSR_lvPT1BOkqn2A"&gt;国内外工控安全领域发展态势（国内篇）&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://mp.weixin.qq.com/s/nU7GT1ki3B55QfvXNtapEQ"&gt;一个你不知道的系统悄然成了全世界最流行的操作系统，危险程度堪比核弹！&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://mp.weixin.qq.com/s/DqK9H_rFrAYCOLAGD0gyBQ"&gt;DHS黑客团队远程入侵了一架波音757&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://hackernews.cc/archives/16852"&gt;新加坡完善新网络安全法案，保障国家关键基础设施安全&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://t.cn/RjbsSxQ"&gt;一夜回到解放前：田纳西州斯普林希尔遭遇勒索软件攻击&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://toutiao.secjia.com/nepalese-banks-swift-server-hacked"&gt;黑客攻击尼泊尔中央银行SWIFT系统 440万美金的转账得手58万&lt;/a&gt;
短评：200多个国家、1.1万多家金融机构在使用SWIFT系统, 每天转移的资金额达数十亿美元。目前，毕马威印度进行数字鉴证审查，SWIFT拒绝就此事置评。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://hackernews.cc/archives/16818"&gt;外媒：朝鲜黑客疑似加大对美国国防承包商的攻击力度，意在窃取知识产权与军事情报&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://hackernews.cc/archives/16764"&gt;瑞典电台遭黑客入侵，播放30分钟IS宣传歌曲&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;技术资料&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://toutiao.secjia.com/icedid-banking-trojan"&gt;Icedid银行木马攻击美金融机构 使用多项先进技术 有IoC&lt;/a&gt;
短评：这些技术包括利用Emotet木马传播、反沙箱、web注入、重定向，甚至在仿冒银行网站上显示真实银行的URL及SSL证书。文末附上Icedid银行木马IoC&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://wikileaks.org/vault8/document/repo_hive/"&gt;维基解密曝光新间谍文档 Vault 8：在线公布 CIA 网络武器 Hive 源代码&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://mp.weixin.qq.com/s/UuOpC49p-e6q2qBXTP7MFQ"&gt;入侵检测浅析&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://toutiao.secjia.com/ordinypt-ransomware"&gt;Ordinypt勒索软件实为清除程序 用随机数据替换文件&lt;/a&gt;
短评：与NotPetya有些类似目的，实际是破坏计算机，目前主要攻击目标为德国境内公司。但小编没想明白，为啥要伪装成勒索软件？文末附上IoC&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://toutiao.secjia.com/joomla-bypass-cve-2017-16634"&gt;Joomla!安全绕过漏洞CVE-2017-16634 3.8.2以下受影响&lt;/a&gt;
短评：攻击者可以利用这个问题，绕过某些安全限制并执行未经授权的操作；这可能有助于发起进一步攻击。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;安全漏洞&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://ics-cert.us-cert.gov/advisories/ICSA-17-318-01"&gt;Siemens无线产品KRACK攻击&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://ics-cert.us-cert.gov/advisories/ICSA-17-318-02"&gt;ABB TropOS KRACK攻击&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://ics-cert.us-cert.gov/advisories/ICSMA-17-318-01"&gt;Philips IntelliSpace Cardiovascular System and Xcelera System远程溢出&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnvd.org.cn/flaw/show/CNVD-2017-33793"&gt;ABB Fox515T embedded Web服务器本地文件包含漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnvd.org.cn/flaw/show/CNVD-2017-33815"&gt;Schneider Electric InduSoft Web Studio和InTouch Machine Edition缓冲区溢出漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnvd.org.cn/flaw/show/CNVD-2017-33807"&gt;AutomationDirect多个产品DLL劫持漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnvd.org.cn/flaw/show/CNVD-2017-32564"&gt;Advantech WebAccess指针引用漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnvd.org.cn/flaw/show/CNVD-2017-30707"&gt;Haiwell Cloud SCADA安卓APP存在密码绕过漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnvd.org.cn/flaw/show/CNVD-2017-32563"&gt;Siemens SIMATIC PCS 7拒绝服务漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnvd.org.cn/flaw/show/CNVD-2017-32444"&gt;Moxa SoftCMS Live Viewer SQL注入漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnvd.org.cn/flaw/show/CNVD-2017-32169"&gt;Trihedral Engineering Limited VTScada未授权访问漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnvd.org.cn/flaw/show/CNVD-2017-32170"&gt;Trihedral Engineering Limited VTScada DLL劫持漏洞&lt;/a&gt; &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnvd.org.cn/flaw/show/CNVD-2017-32177"&gt;ABB FOX515T信息泄露漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://toutiao.secjia.com/foscam-c1-ip-video-camera"&gt;福斯康姆Foscam C1网络摄像头再爆9个漏洞 大多是远程代码执行漏洞&lt;/a&gt;
短评：漏洞涉及攻击点包括web服务DDNS客户端、 CGIProxy.fcgi 固件升级、CGIProxy.fcgi 、devMng Multi-Camera端口、CGIProxy.fcgi注销、UPnP发现等。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://toutiao.secjia.com/graphicsmagick-hbo-cve-2017-16669"&gt;GraphicsMagick堆缓冲区溢出漏洞CVE-2017-16669 可以远程执行代码&lt;/a&gt;
短评：成功的攻击可能会让受影响的应用程序崩溃，进而攻击者可能可以实施远程代码执行攻击，但这还没有得到证实。graphicsmagick版1.3.26受影响；其他版本也可能受到影响。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://toutiao.secjia.com/webaccess-cve-2017-12719"&gt;研华Advantech修复WebAccess两个远程代码执行漏洞 8月的漏洞11月才修复&lt;/a&gt;
短评：分别是WebAccess 缓冲区溢出漏洞 (CVE-2017-14016) 和未受信指针取消引用漏洞 (CVE-2017-12719) ，WebAccess 8.2_20170817 之前版本受到影响。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://toutiao.secjia.com/cisco-products-rci-cve-2017-12277"&gt;思科多产品爆出远程命令注入漏洞CVE-2017-12277 可以执行任意命令&lt;/a&gt;
短评：攻击者可以利用此问题，在受影响的应用程序的上下文中插入和执行任意命令，这可能有助于进一步的攻击。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">chansim</dc:creator><pubDate>Wed, 15 Nov 2017 10:43:00 +0800</pubDate><guid>tag:icsmaster.com,2017-11-15:news/monthly_report_11_1.html</guid><category>news</category></item><item><title>工控安全半月报第一期（2017-10）</title><link>http://icsmaster.com/news/monthly_report_10_2.html</link><description>&lt;blockquote&gt;
&lt;p&gt;工匠安全实验室最新版块，专注工控安全的我们，精选近期全球范围内工控领域的重要事件，让您及时了解行业发展动态，洞悉行业尖端技术，探寻行业前进方向。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;行业动态&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.icscybersecurityconference.com/"&gt;2017 ICS Cyber Security Conference&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://news.hust.edu.cn/2017/1024/c213a88293/page.htm"&gt;首届“武汉工控安全论坛”在校召开&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.guancha.cn/TMT/2017_10_25_432180_s.shtml"&gt;中外黑客“攻击”炼油厂! GeekPwn2017上海站还原乌克兰断电惊天一幕&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://t.cn/ROEBLkU"&gt;乌克兰情报机构发布警示：本月或将再次面临类似NotPetya的网络攻击&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://t.cn/ROEBnZV"&gt;安全公司披露黑客组织Tick新动态，自2012年来持续针对日本关键基础设施、重工业等展开攻击活动&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://t.cn/ROmTuKX"&gt;瑞典交通机构上周曾遭黑客 DDoS 攻击，致使 IT 系统宕机、列车延误&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://t.cn/RO8c7jd"&gt;安全公司披露黑客组织 Tick 新动态，自 2012 年来持续针对日本关键基础设施、重工业等展开攻击活动&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://toutiao.secjia.com/nk-internet"&gt;朝鲜互联网抵近观察报告 趋势科技批驳众多朝鲜攻击者的说法&lt;/a&gt;
短评：有安全研究者认为朝鲜网络管控相当严格，只要是IP显示在朝鲜，那一定是那边的攻击者，然而真是这样的吗？朝鲜互联网是怎样构成的，其中有恶意软件吗？&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://t.cn/RWqiBBM"&gt;美国 DHS 与 FBI 联合预警：黑客将针对美国能源工控企业展开新一轮网络攻击&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://www.ag.gov.au/Consultations/Pages/Security-of-Critical-Infrastructure-Bill.aspx"&gt;澳大利亚《关键基础设施安全法草案2017》解读&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://mp.weixin.qq.com/s?__biz=MzI0MjA2MTg4Nw==&amp;amp;mid=2649166447&amp;amp;idx=1&amp;amp;sn=4b5989474197903a00437ae6d7f8dec9&amp;amp;chksm=f111b53fc6663c292a8a66d9af23f4c5e54c92d6b4e571f4b4bf105efeab0e808acb4629ed2b&amp;amp;mpshare=1&amp;amp;scene=1&amp;amp;srcid=1016DUW7VurQNdaDY2JqZjJH#rd"&gt;工业控制系统已经成为黑客的重要目标&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://bobao.360.cn/news/detail/4306.html"&gt;ISC2017：关键信息基础设施保护论坛&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://toutiao.secjia.com/atm-malware-cutlet-maker"&gt;ATM恶意软件Cutlet Maker在暗网销售 1500美元黑一台ATM机&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;技术资料&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://www.hackers-arise.com/single-post/2016/08/01/SCADA-Hacking-DoSing-a-SCADA-site?_amp_=true"&gt;SCADA Hacking: DoSing a SCADA site&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://github.com/w3h/icsmaster/blob/master/doc/%E5%9B%BD%E5%A4%96/CyberX/CyberX-Global-ICS-IIoT-Risk-Report.pdf"&gt;CyberX-Global-ICS-IIoT-Risk-Report&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.freebuf.com/articles/wireless/150981.html"&gt;WiFi安全漏洞：WPA2安全协议遭破解的影响分析&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://toutiao.secjia.com/amosconnect8-vulnerability"&gt;英国SATCOM船载通信平台有SQL盲注漏洞和后门账户 攻击者可完全控制服务器&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://t.cn/ROmT3Ej"&gt;西门子修复 BACnet 自动化控制器的两处安全漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://toutiao.secjia.com/dragonfly-apt-report"&gt;蜻蜓组织攻击多国能源机构 USCert展示完整攻击链 给出17页报告&lt;/a&gt;
短评：报告分析了完整网络攻击链的7个阶段，从中看到攻击者使用了6种TTP。截止报告时至，国土安全部、联邦调查局和可信合作伙伴认为，攻击仍在持续。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://mp.weixin.qq.com/s?__biz=MzI2MjU3MzQyMA==&amp;amp;mid=2247484577&amp;amp;idx=1&amp;amp;sn=51adb590b3af7613ecd2b9e2400a6b2d&amp;amp;chksm=ea4858a2dd3fd1b413e029ccdcffa0bded7014a80ae5352c74fca9af27672238e0738d4f2522&amp;amp;mpshare=1&amp;amp;scene=1&amp;amp;srcid=1024GmL50IMOgs0z9wr7bfMy#rd"&gt;漂浮在海上的工控系统安全噩梦——轮船&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://github.com/CyberSaxosTiGER/poc-krack"&gt;WPA2 KRACK POC&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://zhuanlan.zhihu.com/p/30242767"&gt;ISC2017应急响应论坛PPT分享&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;安全漏洞&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnvd.org.cn/flaw/show/CNVD-2017-31804"&gt;Korenix JetNet中间人攻击漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnvd.org.cn/flaw/show/CNVD-2017-31805"&gt;Korenix JetNet未授权访问漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnvd.org.cn/flaw/show/CNVD-2017-31344"&gt;Boston Scientific ZOOM LATITUDE PRM硬编码加密漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnvd.org.cn/flaw/show/CNVD-2017-31343"&gt;Boston Scientific ZOOM LATITUDE PRM错误加密漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnvd.org.cn/flaw/show/CNVD-2017-31144"&gt;SpiderControl MicroBrowser任意代码执行漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnvd.org.cn/flaw/show/CNVD-2017-30755"&gt;Wireshark Profinet I/O解析器拒绝服务漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnvd.org.cn/flaw/show/CNVD-2017-30639"&gt;多款Westermo设备硬编码使用加密密钥漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnvd.org.cn/flaw/show/CNVD-2017-30495"&gt;Progea Movicon SCADA/HMI任意代码执行漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnvd.org.cn/flaw/show/CNVD-2017-30496"&gt;Progea Movicon SCADA/HMI权限提升漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-201710-1050"&gt;Siemens APOGEE PXC BACnet Automation Controller和Siemens TALON TC BACnet Automation Controller 路径遍历漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-201710-1049"&gt;Siemens APOGEE PXC BACnet Automation Controller和Siemens TALON TC BACnet Automation Controller 安全漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-201710-1037"&gt;Siemens 7KT PAC1200 Data Manager 安全漏洞&lt;/a&gt; &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-201707-1660"&gt;力控科技-电力通用监控组态软件FCPower XKeyServer组件远程拒绝服务漏洞&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">chansim</dc:creator><pubDate>Tue, 31 Oct 2017 10:43:00 +0800</pubDate><guid>tag:icsmaster.com,2017-10-31:news/monthly_report_10_2.html</guid><category>news</category></item><item><title>利用Modbus PLC作为攻击载荷分发系统</title><link>http://icsmaster.com/security/plcinjecter.html</link><description>&lt;h2&gt;一、    介绍&lt;/h2&gt;
&lt;p&gt;随着互联网+、工业4.0的推进，以前的网络边界被逐渐打破，工业控制系统的安全问题越来越突出，近期针对控制器的攻击层出不穷，如 &lt;a href="http://icsmaster.com/news/logicblob.html"&gt;PLC逻辑炸弹&lt;/a&gt;、&lt;a href="http://icsmaster.com/security/ClearEnergy.html"&gt;PLC勒索软件&lt;/a&gt;，&lt;a href="http://icsmaster.com/security/plcblaster.html"&gt;PLC蠕虫&lt;/a&gt;，相关的技术我们一直在跟踪分析。&lt;/p&gt;
&lt;p&gt;本文主要介绍怎么利用Modbus PLC作为攻击载荷，将恶意代码隐藏在控制器(programmable logic controllers)中，从而躲避当前的主流的网络攻击检测，提高攻击的隐蔽性，使得网络攻击难发现以及难溯源。下文中主要使用是施耐德电气的控制器TM221，该设备使用的主要的通信协议是Modbus Tcp，被中小型制造工厂广泛使用，以实现制造工艺的自动化。由于Modbus Tcp协议存在多个安全问题，利用Modbus Tcp协议可以实现任意上传和下载内存数据，因此，可以将攻击载荷上传至PLC内存中，从而躲避常规的安全检测。&lt;/p&gt;
&lt;h2&gt;二、    利用modbus-cli操作plc寄存器&lt;/h2&gt;
&lt;p&gt;本文中我们使用的控制器，如下图所示：&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/2.png" /&gt;&lt;/p&gt;
&lt;p&gt;使用关键字“TM221ME16R”，在Shodan可以查询到当前暴露在互联网上的施耐德电气，如下图所示。&lt;strong&gt;注意：本文仅做技术研究，相关工具请务在真实工业环境中使用，否则后果自负。&lt;/strong&gt; &lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/1.png" /&gt;&lt;/p&gt;
&lt;p&gt;Modbus-cli是一个命令行（cli）工具，使用此工具可以对PLC 寄存器进行读写操作，使用方法如下图所示：&lt;/p&gt;
&lt;p&gt;运行指令参数：modbus [OPTIONS] SUBCOMMAND [ARG]&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/3.png" /&gt;&lt;/p&gt;
&lt;p&gt;我们至少有两种方法获取寄存器地址里面的值，分别为：Schneider address和Modicon addess。 如下表所示，Modicon addess从地址前的％M开始。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Data type&lt;/th&gt;
&lt;th&gt;Data size&lt;/th&gt;
&lt;th&gt;Schneider address&lt;/th&gt;
&lt;th&gt;Modicon addess&lt;/th&gt;
&lt;th&gt;Parameter&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Word&lt;/td&gt;
&lt;td&gt;16 bits&lt;/td&gt;
&lt;td&gt;%MW100&lt;/td&gt;
&lt;td&gt;400101&lt;/td&gt;
&lt;td&gt;--word&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Interger&lt;/td&gt;
&lt;td&gt;16 bits&lt;/td&gt;
&lt;td&gt;%MW100&lt;/td&gt;
&lt;td&gt;400101&lt;/td&gt;
&lt;td&gt;--int&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Floating point&lt;/td&gt;
&lt;td&gt;32 bits&lt;/td&gt;
&lt;td&gt;%MF100&lt;/td&gt;
&lt;td&gt;400101&lt;/td&gt;
&lt;td&gt;--float&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Double word&lt;/td&gt;
&lt;td&gt;32 bits&lt;/td&gt;
&lt;td&gt;%MD100&lt;/td&gt;
&lt;td&gt;400101&lt;/td&gt;
&lt;td&gt;--word&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Boolean(coils)&lt;/td&gt;
&lt;td&gt;1 bits&lt;/td&gt;
&lt;td&gt;%M100&lt;/td&gt;
&lt;td&gt;101&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;modbus read &lt;IP&gt; %MW100 10，意思是读取以%MW100开头的十个值；我们可以通过modbus-cli从plc中读取指定的寄存器中的值，执行如下图所示：&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/4.png" /&gt;&lt;/p&gt;
&lt;p&gt;为了达到相同的效果，也可以换种形式来获取，如下图所示：&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/5.png" /&gt;&lt;/p&gt;
&lt;p&gt;读取线圈（coils）的值，命令如下&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;modbus read 192.168.1.31 %M100 10
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;可以看出线圈全都处于关闭状态，如下图所示：&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/6.png" /&gt;&lt;/p&gt;
&lt;p&gt;modbus-cli不仅可以读取plc寄存器数据还可以更改，如若被不法份子利用直接可以更改里面的状态值，命令如下：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;modbus write 192.168.1.31 %M100 1 1 1 1 1 1 1 1 1 1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;执行结果如下图所示&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/7.png" /&gt;&lt;/p&gt;
&lt;p&gt;修改PLC寄存器的值时，可能会导致上位机和终端设备的异常运行，下图所示是执行前后&lt;/p&gt;
&lt;p&gt;正常运行状态如下图所示：&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/8.png" /&gt;&lt;/p&gt;
&lt;p&gt;修改寄存器后组态界面出现异常&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/9.gif" /&gt;&lt;/p&gt;
&lt;h2&gt;三、    利用ISF攻击框架进行PLC注入&lt;/h2&gt;
&lt;p&gt;利用plc存储payload/shellcode优势：
由于payload存放在PLC的内存中，所以加大了取证分析的难度。此外，一旦payload被取出，其内容直接被写入内存，这样也加大了取证难度。
此外，我认为Modbus Stager在某些ICS环境中也是非常有用的，因为这些环境下Modbus之外的协议会引起人们的警觉，并且WinHTTP / WinInet stager也不是最适用的。所以，在这种情况下，只需要一个和modbus处理器（stager），读取plc里面的数据并执行。
攻击流程如下：&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/10.png" /&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;attacker将payload/shellcode上传至modbus plc，如果没设定上传得初始地址，那么就从x00开始，在这里其实也可以使用其他工具或者交互脚本，如实验一里面的modbus-cli。攻击者一般会选择第三方的plc，因为第三方的plc具有良好的匿名性质，跟踪难度较大，无须将payload上传至服务器。&lt;/li&gt;
&lt;li&gt;attacker 利用其他方式漏洞或钓鱼等将stager传入工控环境的windows机器并触发运行。&lt;/li&gt;
&lt;li&gt;stager运行之后会与modbus plc数据交互，读取plc保持寄存器里面的payload/shellcode并执行。stager是由汇编编译主要功能是和modbus plc建立socket通信接收payload并在内存执行，总共大小只有1KB，难以被沙软检测，更何况是安全相对薄弱的工控环境。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Payload 生成：
Payload是“Functional Keylogger to File Null-Free Shellcode” 长度为0x0259，在生成的时候前四个字节代表shellcode的长度，如图2-2-2所示：&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/11.png" /&gt;&lt;/p&gt;
&lt;p&gt;为了将payload上传至plc中，plcInjectPayload会根据加载的控制策略不同，对plc的可用内存大小的要求也有所变化，因此该脚本首先检查它们是否有足够的内存空间来存放相应的payload。为了检测内存的大小，可以发送操作功能代码为03（读取保持寄存器）的Modbus请求，尝试从某个地址读取特定记录（每个记录长度为16比特）。如果收到一个0x83异常，那么说明这个PLC对于我们来说是无法使用的。&lt;/p&gt;
&lt;p&gt;Modbus 协议的功能代码如下图所示&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/13.png" /&gt;&lt;/p&gt;
&lt;p&gt;使用ISF下载控制器寄存器，执行操作如下&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/12.gif" /&gt;&lt;/p&gt;
&lt;p&gt;读取到的内容如下图所示&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/14.png" /&gt;&lt;/p&gt;
&lt;p&gt;上传payload至plc，在本次实验没有指定地址，就从0x00开始上传。上传之后的结果如图所示：&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/15.png" /&gt;&lt;/p&gt;
&lt;p&gt;执行stager 获取plc保持寄存器里面payload加载至内存，并执行：&lt;/p&gt;
&lt;p&gt;Stager入口点：&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/16.png" /&gt;&lt;/p&gt;
&lt;p&gt;Socket连接，对应的连接数据如下
  0x1F01A8C0 -&amp;gt; 192.168.1.31 
  0xF6010002 -&amp;gt; port :502&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/17.png" /&gt;&lt;/p&gt;
&lt;p&gt;接收0x259个字节：&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/18.png" /&gt;&lt;/p&gt;
&lt;p&gt;该stager分三次接收数据：&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/19.png" /&gt;&lt;/p&gt;
&lt;p&gt;接收的payload写入内存并执行：&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="/static/images/plcinjector/20.png" /&gt;&lt;/p&gt;
&lt;h2&gt;四、参考&lt;/h2&gt;
&lt;p&gt;[1] Modbus Stager: Using PLCs as a payload/shellcode distribution system  &lt;a href="http://www.shelliscoming.com/2016/12/modbus-stager-using-plcs-as.html"&gt;链接&lt;/a&gt;
[2] Functional Keylogger &lt;a href="https://www.exploit-db.com/exploits/39794/"&gt;链接&lt;/a&gt;
[4] ISF攻击框架 &lt;a href="https://github.com/w3h/isf"&gt;链接&lt;/a&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">chansim</dc:creator><pubDate>Tue, 18 Jul 2017 14:36:00 +0800</pubDate><guid>tag:icsmaster.com,2017-07-18:security/plcinjecter.html</guid><category>工控技术</category><category>PLC注入</category></item></channel></rss>