<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>构建虚拟工控环境系列 - 西门子虚拟PLC - 工匠安全实验室 | 专注于工控安全</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    

    <!-- Open Graph tags -->
            <meta property="og:type" content="article"/>
            <meta property="og:title" content="构建虚拟工控环境系列 - 西门子虚拟PLC"/>
            <meta property="og:url" content="../tool/WinAC_RTX.html"/>
            <meta property="og:description" content="一、 概述 跟随着工控安全一路走来，工控安全市场今年明显有相当大的改善，无论从政策还是客户需求，都在逐步扩大中。但是，搞工控安全研究的人员却寥寥无几。一方面工控安全是个跨学课的技术，需要了解多方面的知识，有比较高的技术上的门槛；另一方面，没有可以研究和学习的便利的环境。一般，搞这方面研究的公司或者个人 ..."/>

    <meta name="description" content="专注于工控网络安全、物联网安全、基础设施安全。" />
    <meta name="keywords" content="工控安全,工匠安全实验室,工控网络安全,物联网安全,基础设施安全,工控安全导航,ics,scada,ics security,scada security" />

    <!-- Bootstrap -->
    <link rel="stylesheet" href="../theme/css/bootstrap.min.css" type="text/css"/>
    <!-- <link href="http://cdn.bootcss.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>   -->
    <link href="../theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="../theme/css/pygments/emacs.css" rel="stylesheet">
    <link rel="stylesheet" href="../theme/css/style.css" type="text/css"/>

        <link href="../feed.xml" type="application/rss+xml" rel="alternate"
              title="工匠安全实验室 | 专注于工控安全 RSS Feed"/>

    <link href="../theme/css/github-markdown.css" rel="stylesheet">

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top myheader" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <a href="../" class="navbar-brand">
<img src="../logo.png" width="40" height="40"/>             </a>
                <div class="brand" id="titlename">工匠安全实验室</div>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse navbar-right">
            <ul class="nav navbar-nav">
                    <li><a href="http://icsmaster.com/index.html">首页</a></li>
                    <li><a href="http://icsmaster.com/category/news.html">最新资讯</a></li>
                    <li><a href="http://icsmaster.com/category/security.html">安全研究</a></li>
                    <li><a href="http://icsmaster.com/category/tool.html">开源工具</a></li>
                    <li><a href="http://icsmaster.com/nav.html">工控安全导航</a></li>
                    <li><a href="http://icsmaster.com/other/about.html">关于我们</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <!--
<li class="banner">
    <a title="网速较慢的话请耐心等待~" href='javascript:(function(){function c(){var e=document.createElement("link");e.setAttribute("type","text/css");e.setAttribute("rel","stylesheet");e.setAttribute("href",f);e.setAttribute("class",l);document.body.appendChild(e)}function h(){var e=document.getElementsByClassName(l);for(var t=0;t<e.length;t++){document.body.removeChild(e[t])}}function p(){var e=document.createElement("div");e.setAttribute("class",a);document.body.appendChild(e);setTimeout(function(){document.body.removeChild(e)},100)}function d(e){return{height:e.offsetHeight,width:e.offsetWidth}}function v(i){var s=d(i);return s.height>e&&s.height<n&&s.width>t&&s.width<r}function m(e){var t=e;var n=0;while(!!t){n+=t.offsetTop;t=t.offsetParent}return n}function g(){var e=document.documentElement;if(!!window.innerWidth){return window.innerHeight}else if(e&&!isNaN(e.clientHeight)){return e.clientHeight}return 0}function y(){if(window.pageYOffset){return window.pageYOffset}return Math.max(document.documentElement.scrollTop,document.body.scrollTop)}function E(e){var t=m(e);return t>=w&&t<=b+w}function S(){var e=document.createElement("audio");e.setAttribute("class",l);e.src=i;e.loop=false;e.addEventListener("canplay",function(){setTimeout(function(){x(k)},500);setTimeout(function(){N();p();for(var e=0;e<O.length;e++){T(O[e])}},15500)},true);e.addEventListener("ended",function(){N();h()},true);e.innerHTML=" <p>If you are reading this, it is because your browser does not support the audio element. We recommend that you get a new browser.</p> <p>";document.body.appendChild(e);e.play()}function x(e){e.className+=" "+s+" "+o}function T(e){e.className+=" "+s+" "+u[Math.floor(Math.random()*u.length)]}function N(){var e=document.getElementsByClassName(s);var t=new RegExp("\\b"+s+"\\b");for(var n=0;n<e.length;){e[n].className=e[n].className.replace(t,"")}}var e=30;var t=30;var n=350;var r=350;var i="//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake.mp3";var s="mw-harlem_shake_me";var o="im_first";var u=["im_drunk","im_baked","im_trippin","im_blown"];var a="mw-strobe_light";var f="//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake-style.css";var l="mw_added_css";var b=g();var w=y();var C=document.getElementsByTagName("*");var k=null;for(var L=0;L<C.length;L++){var A=C[L];if(v(A)){if(E(A)){k=A;break}}}if(A===null){console.warn("Could not find a node of the right size. Please try a different page.");return}c();S();var O=[];for(var L=0;L<C.length;L++){var A=C[L];if(v(A)){O.push(A)}}})()'>High一下!</a>
</li>                -->
                <li><a href="../archives.html"><i class="fa fa-th-list"></i><span class="icon-label">归档</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

   <div class="article-content">
    <section id="content">
        <article>
        <div class="panel panel-default">
            <header class="page-header">
                <h1 class="article-title">
                        构建虚拟工控环境系列 - 西门子虚拟PLC
                    </a>
                </h1>

                <div class="entry-content">
                    <div class="panel-body">
﻿<footer class="article-meta">

	<span class="item name">
            <!-- <span class="label label-default">By</span> -->
            <!-- <a href="../author/feilt.html"><i class="fa fa-user"></i> [<Author u'feilt'>]</a> -->
			
            <i class="fa fa-user"></i><a href="../author/feilt.html">  feilt </a> &nbsp;
			
	</span>
	
	<span class="item time">
	 <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2017-07-30T14:36:00+08:00"> 2017-10-31 15:03:36</time>
    </span>  
	</span>	


	<span class="item tag">
<!-- <span class="label label-default">Tags</span> -->
<a href="../tag/xu-ni-plc.html"><span class="label label-default"> 虚拟PLC </span></a>
        &nbsp; 
<a href="../tag/ruan-plc.html"><span class="label label-default"> 软PLC </span></a>
	</span>
	
    
</footer><!-- /.post-info -->                    </div>
                </div>                  
            </header>

            <div class="entry-content markdown-body">
                <div class="panel-body">
                    <h2>一、    概述</h2>
<p>跟随着工控安全一路走来，工控安全市场今年明显有相当大的改善，无论从政策还是客户需求，都在逐步扩大中。但是，搞工控安全研究的人员却寥寥无几。一方面工控安全是个跨学课的技术，需要了解多方面的知识，有比较高的技术上的门槛；另一方面，没有可以研究和学习的便利的环境。一般，搞这方面研究的公司或者个人，都会先购买一些硬件设备，搭建一个模拟环境，再做相应的安全研究，成本实在是太高。为了解决这个问题，我们做了一系列的相关的技术研究，通过构建一套虚拟的工业控制环境，从而降低了解和学习工控安全的门槛，推动相关人才的培养。</p>
<p>本篇主要介绍西门子虚拟PLC，使用的操作系统为Windows7 x86 Ultimate，虚拟化软件为 VMware Workstation 12 Pro，（SIEMENS）WinAC RTX 2010。</p>
<h2>二、    控制器虚拟化技术介绍</h2>
<p>可编程控制器，即PLC。PLC的实现分为硬PLC和软PLC。 所谓硬PLC从严格意义上来说是由硬件或者一块专用的ASIC芯片来实现PLC指令的执行．而软PLC是用一些通用的CPU或者MCU来实现PLC指令的解释或者编译持行。</p>
<p>软件PLC（SoftPLC，也称为软逻辑SoftLogic）是一种基于基于PC机开发结构的控制系统，它具有硬PLC在功能、可靠性、速度、故障查找等方面的特点，利用软件技术可以将标准的工业PC转换成全功能的PLC过程控制器。软件PLC综合了计算机和PLC的开关量控制、模拟量控制、数学运算、数值处理、网络通信、PID调节等功能，通过一个多任务控制内核，提供强大的指令集、快速而准确的扫描周期、可靠的操作和可连接各种I/O系统的及网络的开放式结构。所以，软件PLC 提供了与硬PLC同样的功能，同时又提供了PC环境的各种优点。</p>
<p>虚拟机技术是虚拟化技术的一种，所谓虚拟化技术就是将事物从一种形式转变成另一种形式，最常用的虚拟化技术有操作系统中内存的虚拟化，实际运行时用户需要的内存空间可能远远大于物理机器的内存大小，利用内存的虚拟化技术，用户可以将一部分硬盘虚拟化为内存，而这对用户是透明的。又如，可以利用虚拟专用网技术（VPN）在公共网络中虚拟化一条安全，稳定的“隧道”，用户感觉像是使用私有网络一样。</p>
<p>如果将软PLC安装在虚拟机下，在软PLC出现故障时，用备份的虚拟机代替当前的虚拟机，即可快速恢复系统运行；此外，开发人员不必在现场，即可开发调试项目，在调试完成后，将包含软PLC的虚拟机直接放在现场的工控计算机上就直接可以完全运行。但是软PLC目前只能在物理PC上安装运行，在虚拟机下可以安装，但不能运行，这是由于软PLC需要直接驱动硬件，而虚拟机中的硬件都是虚拟造成的。</p>
<h2>三、西门子虚拟化WinAC产品分类</h2>
<p>SIMATIC WinAC是西门子公司开发的基于PC控制的核心组件，它的出现扩展了SIMATIC S7的控制范围。WinAC是一个名副其实的控制中心，它将PLC控制、数据处理、通讯、可视化及工艺集成于一台PC机上。 SIMATIC WinAC产品包括软件型和插槽型两大类，包括如下5种产品： </p>
<ul>
<li>
<p>1、WinAC Basis (WinAC 基本型) 
WinAC Basis 是低成本解决方案，用于对控制无精确时间要求，有大量、快速的数据处理与控制任务(控制任务指PLC的控制功能)相结合或其它PC任务的控制场合。</p>
</li>
<li>
<p>2、WinAC PN 
第一个支持PROFInet通讯标准的SIMATIC CPU，性能与WinAC Basis相似。WinAC PN支持基于组件的自动化(CBA)和PROFInet通讯标准。基于组件的自动化和PROFInet提供了一个开放的标准，用于在复杂任务中机械和系统单元之间的数据交换。数据交换通过SIMATIC iMap工具来进行配置。WinAC PN适应于以下任务：
整个复杂系统的机械和车间区域之间的协调和连接 来自系统单元或机械可被集成到一个全范围的复杂系统控制WinAC Basis 4.1有一个选件WinAC PN，带有WinAC PN选件的WinAC Basis 4.1支持PROFInet和CBA。</p>
</li>
<li>
<p>3、WinAC RTX(WinAC 实时型) 
WinAC RTX 提供了Windows 2000/XP的实时子系统，具有“硬实时”和“抗死机”特性。适应于具有高速和精确时间要求的控制任务的场合，如运动控制、闭环控制等。 </p>
</li>
<li>
<p>4、WinAC MP 
WinAC MP基于WinCE操作系统和SIMATIC MP370(一种多功能面板)硬件平台。MP370为无硬盘、无风扇设计，WinCE具有实时特性，可实现严格的确定性动作。WinAC MP用在恶劣工业环境和有大量数据要处理的场合。 </p>
</li>
<li>
<p>5、WinAC Slot 412/416 
以板卡的形式插入在PC中，在板卡上已经集成了用于控制任务的CPU、存储器等元件。它可独立于PC进行控制操作。板卡上集成一个MPI/DP接口和一个DP口。WinAC Slot适用于对安全性和稳定性要求较高的场合。WinAC Slot 412/416在性能上与S7-412/416相近。</p>
</li>
</ul>
<h2>四、虚拟控制器WinAC RTX搭建</h2>
<p>1、打开虚拟机系统的安装目录，找到后缀名是“.vmx”的文件，然后用记事本打开。</p>
<p><img alt="Alt text" src="/static/images/WinAC_RTX/1.png" /></p>
<p>2、添加虚拟网卡设备，添加如下配置。如果配置文件中已存在，则不添加“ethernet0.virtualDev = "e1000e"”，直接将等号后面的值改为"e1000e"。</p>
<div class="highlight"><pre>ethernet0.virtualDev = &quot;e1000e&quot;
bios440.filename=&quot;FUJITSU211_314.ROM&quot;
</pre></div>


<p><img alt="Alt text" src="/static/images/WinAC_RTX/2.png" /></p>
<p>3、在西门子技术支持的官网（<a href="https://support.industry.siemens.com">https://support.industry.siemens.com</a>）下载文件“FUJITSU211_314.ROM”，并将在虚拟机安装目录下。此文件是将虚拟机硬件映像成FUJITSU PRIMERGR服务器。如下图所示。</p>
<p><img alt="Alt text" src="/static/images/WinAC_RTX/3.png" /></p>
<p>4、打开运行虚拟机，配置当前主机的IP地址。</p>
<p><img alt="Alt text" src="/static/images/WinAC_RTX/6.png" /></p>
<p>5、使用虚拟光驱安装WinAC RTX 2010。</p>
<p><img alt="Alt text" src="/static/images/WinAC_RTX/4.png" /></p>
<p>6、安装完后启动station Configurator。</p>
<p><img alt="Alt text" src="/static/images/WinAC_RTX/5.png" /></p>
<p>7、打开的窗口中添加WinLC RTX，添加通讯网卡“IE 通用”</p>
<p><img alt="Alt text" src="/static/images/WinAC_RTX/7.png" /></p>
<p>8、此时会发现桌面上多出一个图标，此图标就是虚拟PLC的图标，双击打开即可。至此，就完成了在虚拟机中安装PLC。</p>
<p><img alt="Alt text" src="/static/images/WinAC_RTX/8.png" /></p>
<h2>五、虚拟控制器组态</h2>
<p>1、打开step7软件，创建工程，并进行组态配置，配置方法如下图所示。</p>
<p><img alt="Alt text" src="/static/images/WinAC_RTX/9.png" /></p>
<p>2、编写一个小的测试程序。</p>
<p><img alt="Alt text" src="/static/images/WinAC_RTX/10.png" /></p>
<p>3、编译并下载组态程序。</p>
<p><img alt="Alt text" src="/static/images/WinAC_RTX/11.png" /></p>
<p>4、监控运行，如果一切正常，即显示为“RUN”状态。</p>
<p><img alt="Alt text" src="/static/images/WinAC_RTX/12.png" /></p>
<p>5、可以使用step7软件控制虚拟PLC的启停。</p>
<p><img alt="Alt text" src="/static/images/WinAC_RTX/13.png" /></p>
<p>至此，就完成了虚拟PLC的搭建。</p>
                </div>
            </div>  
  
            <div class="panel-body">

<!-- JiaThis Button BEGIN -->
<script type="text/javascript" >
var jiathis_config={
	data_track_clickback:true,
	siteNum:5,
	sm:"weixin,tqq,qzone,tsina,cqq",
	summary:"",
	showClose:true,
	shortUrl:true,
	hideMore:true
}
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jiathis_r.js?uid=2128692&type=left&btn=l5.gif&move=1" charset="utf-8"></script>
<!-- JiaThis Button END -->


    <div>
        <br />
        <hr />
        <ul>
            <li>
                <a href="../security/plcinjecter.html">
                    上一篇文章：利用Modbus PLC作为攻击载荷分发系统
                </a>
            </li>
            <li>
                <a href="../tool/AB_VPLC.html">
                    下一篇文章：构建虚拟工控环境系列 - 罗克韦尔虚拟PLC
                </a>
            </li>
        </ul>
    </div>
            </div>
        </div>

        <div class="panel panel-default">
            <div class="panel-body">
                <!-- /.entry-content -->
<!-- UY BEGIN -->
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2138476"></script>
<!-- UY END -->
            </div>
        </div>    
        </article>
    </section>
	</div>
        </div>
        <div class="col-sm-3" id="sidebar">
<div class="sidebar_main">
<div class="well well-sm" id="sidebar">
<aside>
    <section>
        <ul class="list-group list-group-flush">
                <li class="list-group-item">
                <div>
                    <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">近期文章</span></h4>
                </div>
                    <ul class="list-group" id="recentposts">
                        <li class="list-group-item">               
                            <a href="../security/Triton_src_analysis.html">
                               <span class="glyphicon glyphicon-volume-down"></span> Triton核心源代码分析
                            </a>
                        </li>
                        <li class="list-group-item">               
                            <a href="../news/monthly_report_12_2.html">
                               <span class="glyphicon glyphicon-volume-down"></span> 工控安全半月报第五期（2017-12 下）
                            </a>
                        </li>
                        <li class="list-group-item">               
                            <a href="../news/hk_conference.html">
                               <span class="glyphicon glyphicon-volume-down"></span> 工匠安全实验室受邀赴港参加DragonCon2017会议
                            </a>
                        </li>
                        <li class="list-group-item">               
                            <a href="../news/monthly_report_12_1.html">
                               <span class="glyphicon glyphicon-volume-down"></span> 工控安全半月报第四期（2017-12 上）
                            </a>
                        </li>
                        <li class="list-group-item">               
                            <a href="../news/monthly_report_11_2.html">
                               <span class="glyphicon glyphicon-volume-down"></span> 工控安全半月报第三期（2017-11 下）
                            </a>
                        </li>
                        <li class="list-group-item">               
                            <a href="../news/monthly_report_11_1.html">
                               <span class="glyphicon glyphicon-volume-down"></span> 工控安全半月报第二期（2017-11 上）
                            </a>
                        </li>
                        <li class="list-group-item">               
                            <a href="../security/virtual_platform.html">
                               <span class="glyphicon glyphicon-volume-down"></span> 工业系统虚拟化测试平台搭建
                            </a>
                        </li>
                        <li class="list-group-item">               
                            <a href="../news/monthly_report_10_2.html">
                               <span class="glyphicon glyphicon-volume-down"></span> 工控安全半月报第一期（2017-10）
                            </a>
                        </li>
                        <li class="list-group-item">               
                            <a href="../tool/AB_VPLC.html">
                               <span class="glyphicon glyphicon-volume-down"></span> 构建虚拟工控环境系列 - 罗克韦尔虚拟PLC
                            </a>
                        </li>
                        <li class="list-group-item">               
                            <a href="../tool/WinAC_RTX.html">
                               <span class="glyphicon glyphicon-volume-down"></span> 构建虚拟工控环境系列 - 西门子虚拟PLC
                            </a>
                        </li>
                    </ul>
                </li>
    </section>            
</aside>
</div> 
</div> 

<div class="sidebar_main">
<div class="well well-sm" id="sidebar">
<aside>
    <section>

    <li class="list-group-item"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">最新评论</span></h4></a>
    <!-- UYAN NEW COMMENT BEGIN -->
    <div id="uyan_newcmt_unit"></div>
    <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2128692"></script> <!-- 如果已经过加载此行JS，即可不用重复加载 -->
    <!-- UYAN NEW COMMENT END -->
    </li>
    </section>            
</aside>
</div> 
</div> 

<div class="sidebar_main">
<div class="well well-sm" id="sidebar">
<aside>
    <section>

    <li class="list-group-item"><h4><i class="fa fa-github fa-lg"></i><span class="icon-label">GitHub</span></h4>
        <div id="gh_repos">
            <p class="list-group-item">Status updating...</p>
        </div>
    </li>
    </section>            
</aside>
</div> 
</div> 

<div class="sidebar_main">
<div class="well well-sm" id="sidebar">
<aside>
    <section>
    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">友情链接</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://dragoncon.hk/" target="_blank">
                DRAGONCON
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://www.waitalone.cn/" target="_blank">
                独自等待
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://plcscan.org/blog/" target="_blank">
                灯塔实验室
            </a>
        </li>
      </ul>
    </li>
    </section>            
</aside>
</div> 
</div>    
        </div>
    </div>
</div>
<footer class="myfooter">
   <div class="container">
      <div class="row">
         <div class="col-xs-10">&copy; 2018 W3H
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#" id="pull-right-link">Back to top</a></p></div>
      </div>
   </div>
</footer>


<script type="text/javascript">
    if(document.body.scrollWidth < 700){
      document.getElementById('pull-right-link').style.display = 'none';
    }
</script>
<script src="http://code.jquery.com/jquery.js"></script>
<!-- <script src="http://cdn.bootcss.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>  -->
<script src="../theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="../theme/js/respond.min.js"></script>

<!-- For the Tags Cloud -->
<script type="text/javascript">
if(document.body.scrollWidth < 1024){
      document.getElementById("titlename").innerHTML="工匠安全实验室";
}
</script>

    <!-- GitHub JS -->
    <script type="text/javascript">
        $(document).ready(function () {
            if (!window.jXHR) {
                var jxhr = document.createElement('script');
                jxhr.type = 'text/javascript';
                jxhr.src = '../theme/js/jXHR.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(jxhr, s);
            }

            github.showRepos({
                user: 'w3h',
                count: 5,
                skip_forks: false,
                target: '#gh_repos'
            });
        });
    </script>
    <script src="../theme/js/github.js" type="text/javascript"></script>
    <!-- End GitHub JS Code -->


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8dd91be64f13d3df23dfc64664c3101b";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

</body>
</html>